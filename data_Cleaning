import kagglehub
import pandas as pd
import os
import matplotlib.pyplot as plt

#load in data
path = kagglehub.dataset_download("mexwell/nba-shots")

print("Dataset folder:", path)
print("Files in folder:", os.listdir(path))
all_files = [f for f in os.listdir(path) if f.endswith(".csv")]

df_list = []
for file in all_files:
    file_path = os.path.join(path, file)
    print(f"Loading {file}...")
    temp_df = pd.read_csv(file_path)
    df_list.append(temp_df)

# Combine all season files into a single dataset
df = pd.concat(df_list, ignore_index=True)

print(df.shape)
print(df.head())
print(df.info())
#keeping only relevant columns
keep_cols = [
    "SEASON_1", "TEAM_ID", "TEAM_NAME", "PLAYER_ID", "POSITION", 
    "HOME_TEAM", "AWAY_TEAM", "SHOT_MADE", "ACTION_TYPE", "SHOT_TYPE",
    "BASIC_ZONE", "ZONE_NAME", "ZONE_ABB", "ZONE_RANGE", "LOC_X", "LOC_Y"
]
df_cleaned = df[keep_cols].copy()
#7930 missing values - all in POSITION column
df_cleaned = df_cleaned.dropna()
#removed all rows with x or y values outside 0-50 range (mainly back court shots)
df_cleaned = df_cleaned[~((df_cleaned["LOC_X"].abs() > 50) | (df_cleaned["LOC_Y"] > 50) | (df_cleaned["LOC_X"].abs() < 0) | (df_cleaned["LOC_Y"].abs() < 0))]
print("Cleaned dataset shape:", df_cleaned.shape)
print(df_cleaned.head())
print(df_cleaned.info())
